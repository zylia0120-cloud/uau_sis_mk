import matplotlib.pyplot as plt
import numpy as np
from matplotlib.ticker import MultipleLocator

# 模拟数据
point = 100
lamb_list = [1 * i / point for i in range(1 + point)]

# MC
rho_a1 = [0.7342347115622678, 0.742092597177519, 0.7589928200049514, 0.7733750928447638, 0.7829319138400602, 0.7895251299826692, 0.7947184946769011, 0.7990373854914588, 0.8017152760584311, 0.8052384253528101, 0.8073939093835107, 0.808975488982422, 0.8110408516959642, 0.8123763307749439, 0.8139390938351073, 0.8157524139638519, 0.8165179499876208, 0.8169903441445902, 0.8182525377568705, 0.8187363208715025, 0.8195177024015851, 0.8204050507551367, 0.8204897251795007, 0.821538499628621, 0.8216974498638275, 0.8217524139638525, 0.8221990591730624, 0.8227818767021546, 0.8229987620698195, 0.8235800940826945, 0.8233711314681845, 0.8236315919782127, 0.8239836593216143, 0.8249076504085169, 0.8247823718742265, 0.8251255261203266, 0.8250710571923747, 0.8254399603862347, 0.825590987868284, 0.8256454567962368, 0.8261891557316163, 0.8267571180985395, 0.8265833127011639, 0.826706610547165, 0.8269913344887345, 0.8267184946768997, 0.8267655360237679, 0.8274285714285725, 0.827435008665511, 0.8271205743996042, 0.8273973755880171, 0.8270661054716517, 0.8279529586531328, 0.8277014112404066, 0.8279222579846496, 0.827487992077247, 0.8280470413468677, 0.8279589007179995, 0.82804753651894, 0.828691260212924, 0.8282921515226545, 0.8284005942064872, 0.8280450606585785, 0.828183708838822, 0.8284892300074277, 0.8286031195840554, 0.8287754394652144, 0.8283040356523896, 0.8284822975984155, 0.8287452339688036, 0.8291473136915072, 0.8289784600148553, 0.828936865560783, 0.8290378806635307, 0.8294795741520183, 0.8288710076751674, 0.829347363208716, 0.8288328794256008, 0.8293087397870759, 0.8292225798464965, 0.8292097053726166, 0.8294152017826194, 0.8293419163159201, 0.8289284476355538, 0.8295033424114879, 0.8295776182223321, 0.8296127754394652, 0.8295087893042831, 0.8295186927457298, 0.8290918544194115, 0.8295528596187183, 0.8296830898737318, 0.8298950235206736, 0.8294315424610053, 0.8296850705620202, 0.8299376083188919, 0.8298370883882139, 0.8299133448873486, 0.8296261450854172, 0.8298781876702155, 0.8295038375835606]
rho_a2 = [0.73777795182905, 0.746511712837579, 0.7633925386366804, 0.7775282475721484, 0.7869074753457554, 0.7936725417001933, 0.7985307863667241, 0.8029473523024088, 0.8062680425356796, 0.8092675708165387, 0.8111608221393528, 0.8136070058044662, 0.8151255875257587, 0.8164704775195227, 0.8175558904532295, 0.8191041822804356, 0.8200562270062993, 0.8209349761723368, 0.8217436029520623, 0.8221862004844599, 0.8232726009710664, 0.823711554778913, 0.8243081593850846, 0.8246694326558266, 0.8250799642436466, 0.8257684127463528, 0.8260320981971103, 0.8265336020824423, 0.8267409397603788, 0.8273791595588722, 0.8274371987686084, 0.8274692111320636, 0.8279228731837217, 0.8280705105984115, 0.828245375946675, 0.8286270321284684, 0.828774597565307, 0.828939148897728, 0.8291642547844711, 0.8292578867163898, 0.8294385823526581, 0.8297249962708793, 0.829875816679642, 0.8300523606037493, 0.8300628601065705, 0.8302541107227956, 0.8303556507552556, 0.830309370421138, 0.8305871026087963, 0.8304749621803815, 0.8306898321146741, 0.8307200910994421, 0.8306996008420071, 0.8309438087220159, 0.8311213075267705, 0.8312383382337535, 0.8313579605147068, 0.8312577592520514, 0.8313388575065066, 0.8314885213537185, 0.8314959694830718, 0.8315572570978315, 0.8317226487089456, 0.8317328821103457, 0.8317338226180157, 0.8318699599168672, 0.83192006576453, 0.8319334343591733, 0.8320250825656909, 0.8321708914008016, 0.8320609251032894, 0.832219828855118, 0.8322388746786126, 0.8322857861491143, 0.83225255159547, 0.8323414605570406, 0.8323358170807521, 0.8324105197977946, 0.8324146309958773, 0.8325808459155908, 0.8325033498283588, 0.8325654402050767, 0.8325580905971295, 0.8326080014970089, 0.8326377836032464, 0.832699469437339, 0.8327739300025111, 0.8326942334939321, 0.832745288265491, 0.8328622893233476, 0.8328722871372871, 0.832817932573601, 0.8329511485795176, 0.8329677442201794, 0.832941657007434, 0.832932385319448, 0.8330598370944298, 0.8330514374338854, 0.8330464788773513, 0.8330473240488717, 0.8330916068477734]

rho_i1 = [0.0, 0.05199306759098788, 0.15963109680613993, 0.24978658083684097, 0.3177261698440206, 0.3668036642733351, 0.40463233473632076, 0.43599405793513246, 0.460979450359, 0.4822693736073289, 0.5001906412478333, 0.5167353305273577, 0.5304951720722951, 0.5432820004951722, 0.5537276553602374, 0.5635251299826682, 0.5728185194355039, 0.5800896261450856, 0.5873914335231492, 0.5933731121564743, 0.5999633572666501, 0.6048338697697441, 0.6100287199801929, 0.6149551869274574, 0.6191408764545682, 0.6225293389452828, 0.6262163901955929, 0.6299856400099035, 0.6335895023520677, 0.6362223322604611, 0.6387482050012376, 0.6414964100024759, 0.6444392176281261, 0.6465060658578862, 0.6482753156721955, 0.6516053478583821, 0.652894280762564, 0.6549036890319387, 0.6565417182470903, 0.6582629363703887, 0.6599846496657588, 0.6616410002475858, 0.662836345630107, 0.6640891309730135, 0.6661445902451107, 0.6671230502599659, 0.6678712552612032, 0.669435999009656, 0.6709512255508796, 0.6716360485268638, 0.673225055706858, 0.6735370141124049, 0.6745808368408015, 0.6755290913592473, 0.6766575885120081, 0.6779430552116859, 0.6784456548650657, 0.6796642733349837, 0.6796796236692249, 0.6805298341173558, 0.6811091854419409, 0.6827828670462988, 0.6825540975488987, 0.6833156721960884, 0.6842668977469667, 0.6845134934389707, 0.6851700916068346, 0.6859757365684572, 0.686563505818272, 0.6864085169596439, 0.6875924733845009, 0.688118346125278, 0.6884917058677885, 0.6888086159940576, 0.6895152265412237, 0.6899767269126023, 0.6902030205496408, 0.6908061401336966, 0.6911487992077243, 0.6916791284971523, 0.692006932409012, 0.69233869769745, 0.6926313443921777, 0.6934374845258725, 0.6934805644961632, 0.6937781629116114, 0.6937880663530577, 0.6948784352562505, 0.6950408516959643, 0.6948601138895771, 0.6958098539242394, 0.6957454815548406, 0.6962208467442426, 0.6962342163901954, 0.6965139886110417, 0.6969165635058187, 0.6971601881653877, 0.6973493438970041, 0.6973181480564498, 0.6976226788809105, 0.6981559792027732]
rho_i2 = [5.1231707973278705e-46, 0.05363179559087028, 0.16597301353558555, 0.2575556212276882, 0.32310351619271865, 0.3720998386049352, 0.4103237124777469, 0.44127579393002647, 0.46701125783231295, 0.4885586370590313, 0.5069934092550575, 0.5227430228305026, 0.536543698023116, 0.5486610583724268, 0.5594006726533365, 0.5688971005379106, 0.5774730908263369, 0.5852052733277622, 0.5922125301438154, 0.5986262650461991, 0.6044134247587987, 0.6097865415956625, 0.6147135900410873, 0.6192844246147032, 0.6235109586503467, 0.6274077474429942, 0.6310729593635602, 0.6344705736397613, 0.63767253331518, 0.6406352611446079, 0.6434642599199526, 0.6461267128707648, 0.6486010071062975, 0.6509589479602101, 0.6531847784090055, 0.6552753870303744, 0.6572731050010617, 0.6591670798322465, 0.6609617714328393, 0.6626773569975196, 0.664304699942556, 0.665848490971904, 0.6673298254662475, 0.6687425903562877, 0.6701030813164189, 0.671393417120043, 0.6726340477807868, 0.6738314155485827, 0.6749607661832049, 0.6760665760858313, 0.6771101632366955, 0.6781230568916139, 0.6790997403380542, 0.680025371142312, 0.6809199486253368, 0.6817847830280923, 0.6826182089143421, 0.683432922205599, 0.6842101527611468, 0.6849571613044925, 0.6856854519768466, 0.6863867129240987, 0.6870598695409259, 0.6877180424767183, 0.6883553642092413, 0.6889663570701567, 0.6895618494990516, 0.6901403979575778, 0.6906978396949961, 0.6912360769873179, 0.6917687440303485, 0.6922746533506348, 0.69277136013405, 0.6932525698794487, 0.6937231402268192, 0.6941756519647466, 0.694619096282868, 0.6950472163944165, 0.69546622450379, 0.6958678912497333, 0.6962676264613789, 0.6966517260867896, 0.6970281797759478, 0.6973928180708501, 0.6977487438595791, 0.6980944819043335, 0.6984310351024661, 0.6987643033757158, 0.6990849776377517, 0.6993956039973797, 0.6997021066077901, 0.7000032569370496, 0.7002912752667417, 0.7005760899787706, 0.7008555175681704, 0.7011279117579651, 0.7013898758001804, 0.7016498796303023, 0.7019038643832939, 0.7021519458771237, 0.7023932165930973]

# 创建画布和子图
fig, axes = plt.subplots(2, 1, figsize=(6, 4), sharex=True)

# -------- 上图 ρ^A --------
axes[0].plot(lamb_list, rho_a2, 'r-', label='MMCA', linewidth=1.5)
axes[0].plot(lamb_list, rho_a1, 'b.', label='MC', markersize=4)
axes[0].set_ylabel(r'$\rho^A$', fontsize=12)
axes[0].legend(frameon=True, edgecolor='black', fontsize=10, loc='lower right')
axes[0].set_xlim(0, 1)
axes[0].set_ylim(0.6, 1)

# -------- 下图 ρ^I --------
axes[1].plot(lamb_list, rho_i2, 'r-', label='MMCA', linewidth=1.5)
axes[1].plot(lamb_list, rho_i1, 'b.', label='MC', markersize=4)
axes[1].set_xlabel(r'$\beta$', fontsize=12)
axes[1].set_ylabel(r'$\rho^I$', fontsize=12)
axes[1].legend(frameon=True, edgecolor='black', fontsize=10, loc='lower right')
axes[1].set_xlim(0, 1)
axes[1].set_ylim(0, 0.7)

# -------- 设置主次刻度 --------
for ax in axes:
    # X轴主刻度 0.2，次刻度 0.1
    ax.xaxis.set_major_locator(plt.MultipleLocator(0.2))
    ax.xaxis.set_minor_locator(plt.MultipleLocator(0.1))
    # Y轴主刻度 0.2，次刻度 0.1
    ax.yaxis.set_major_locator(plt.MultipleLocator(0.2))
    ax.yaxis.set_minor_locator(plt.MultipleLocator(0.1))
    # 让主次刻度都朝内
    ax.tick_params(which='major', length=5, direction='in', top=True, bottom=True, left=True, right=True)
    ax.tick_params(which='minor', length=3, direction='in', top=True, bottom=True, left=True, right=True)

plt.tight_layout()

# === 调整子图间距 ===
plt.subplots_adjust(top=0.96, hspace=0.15)

# === 保存图形 ===
plt.savefig('Fig1.eps', format='eps', dpi=300, bbox_inches='tight')
plt.savefig('Fig1.pdf', format='pdf', dpi=300, bbox_inches='tight')
plt.show()